---
title: Sandboxing with chroot
date: "2023-05-21T14:34:00"
template: "post"
draft: false
slug: "chroot"
category: "Blog"
tags:
  - "Unix"
  - "Security"
description: "Learn about what chroot is and how to create a chroot jail"
---

<br>

```
/
├── bin
├── usr
├── var
├── lib
├── mychroot
│   ├── bin
│   ├── lib
│   ├── ...
├── ...
```

## What is `chroot`

_[chroot](https://en.wikipedia.org/wiki/Chroot)_ is an operation in unix and unix-like operating systems that allows users to change the root directory of a process and its children to a new location on the filesystem. 

When you chroot a process, you are essentially creating a new filesystem environment for that process and its children. Access to files and directories is restricted within the new root directory. The sandboxed environment created by chroot is sometimes called a **chroot jail**, which is useful for a variety of purposes, such as security, testing, and recovery.

## Demo

The following is a demo of running bash in a chroot environment.

https://unix.stackexchange.com/questions/746497/chroot-bash-not-working-after-copying-both-the-binary-and-its-dependancies



Note: why only copy the dependencies with => 

The reason we only copy the shared libraries with the => symbol is because these are the ones that are dynamically linked by the bash binary. When a binary is dynamically linked to a shared library, it means that the binary will look for the library at runtime and load it into memory if it exists.

In contrast, when a binary is statically linked to a library, it means that the library code is copied into the binary at compile time, and the binary doesn't need to look for the library at runtime.

So, when we copy the shared libraries with the => symbol to the /mychroot/lib directory, we are ensuring that the bash binary will be able to find these libraries at runtime when it is executed inside the chroot environment. This is necessary because the chroot environment is a separate filesystem environment, and it needs to have access to all the files and libraries that are required by the processes running inside it.



## Final Words

TBD
